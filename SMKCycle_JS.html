<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <style>
        *{margin: 0; padding: 0;}
        ul {position: absolute; bottom: 10px; width: 100%; text-align: center;}
        ul li {display: inline-block; list-style: none; width:20px; height: 20px; border-radius: 10px; background: #999; color: #fff; font-weight: bold;font-size: 14px; text-align: center;line-height: 20px;}
        li.on {background: #c30;}
    </style>
</head>
<script src="./js/jquery-1.11.3.js">
    
</script>
<body>
    <div id="box">
        <div id="canvas">
        </div>
        <ul>
            <li class="on">1</li>
            <li>2</li>
            <li>3</li>
        </ul>

    </div>   
        <button id="pre">上一页</button>
        <button id="next">下一页</button>
    <script>

        $(function(){

            // 初始化数据
            var imgs = ['images/jd1.jpg','images/jd2.jpg','images/jd3.jpg']
            //定时器
            var timer; 
            // 动画时长
            var timer_duration = 3000;
            var animate_duration = 900;
            // 几组
            var per_section = 3; 
            // 每组几个
            var per_row = imgs.length;
            // 初始化索引
            var index = per_row;
            // 屏幕宽度
            var screen_width = $(window).width();
            // 索引对象
            var indexPath = {
                row : 0,
                section: 0
            }


            // 生成图片数组
            var imgs_array = [];
            $.each(imgs,function(){
                imgs_array = imgs_array.concat(imgs);
            })
            $.each(imgs_array, function(k,v){
                $('#canvas').append('<a href=""><img src="'+ v +'" alt=""></a>')
            })

            // 绑定样式
            $('#box').css({"width" : screen_width + 'px', "height" : '454px','margin': '50px auto 0', 'position': 'relative'})
            $('#canvas').css({"width" : screen_width * per_row * per_section + 'px', "height" : '454px','position': 'absolute', 'left': '0', 'top': '0'})
            $('#canvas a').css({"width" : screen_width + 'px', "height" : '454px','float': 'left'})
            $('#canvas img').css({"width" : screen_width + 'px', "height" : '454px'})

    
            // 初始定位 第一组 第一个
            indexPath.section = Math.floor(per_section / 2);
            indexPath.row = 0;
            var num = indexPath.section * per_row + indexPath.row;
            $('#canvas').animate({left: -screen_width * num + 'px'}, 0);

            // 开始动画轮播
            start_cycle();
        
            function start_cycle(){
                timer = setInterval(function(){
                    next_page();
                },timer_duration);
            }
            
            // 绑定事件
            $("img").bind({
                click:function(){},
                mouseover:function(){clearInterval(timer);},  
                mouseout:function(){start_cycle();}  
            });
            $('#pre').click(function(){
                pre_page();
            })
            $('#next').click(function(){
                next_page();
            })
        
            
            // 上一页
            function pre_page() {
                clearInterval(timer);
                // 重置位置
                reset_page();
                // 下一个需要展示的位置
                // 上一次   第一组 1  第一个 0
                // 下一次   第0组  0  第2个 2
                var nextItem = indexPath.row - 1;
                var nextSection = indexPath.section;
                if (nextItem < 0 ) {
                    nextItem = 2;
                    nextSection--;
                }
                var next_num = nextSection * per_row + nextItem;
                $('#canvas').animate({left: -screen_width * next_num  + 'px'}, animate_duration, function(){
                    $('li').removeClass();
                    $('li').eq(nextItem).addClass('on');
                    start_cycle();
                    indexPath.row --;
                    if (indexPath.row < 0 ) {
                        indexPath.row = 2;
                    }
                    indexPath.row %= 3;
                });
            }

            // 下一页
            function next_page(){
                clearInterval(timer);   
                // 重置位置
                reset_page();

                // 下一个需要展示的位置
                var nextItem = indexPath.row + 1;
                var nextSection = indexPath.section;
                if (nextItem == per_row) {
                    nextItem = 0;
                    nextSection++;
                }
                var next_num = nextSection * per_row + nextItem;
                $('#canvas').animate({left: -screen_width * next_num  + 'px'}, animate_duration, function(){
                    $('li').removeClass();
                    $('li').eq(nextItem).addClass('on');
                    start_cycle();
                    indexPath.row ++;
                    indexPath.row %= 3;
                });
    
            }

            // 重置位置
            function reset_page() {
                // 重置位置
                var row = indexPath.row;
                var section = Math.floor(per_section / 2)
                var num = section * per_row + row;
                $('#canvas').animate({left: -screen_width * num + 'px'}, 0);
            }

     })
    </script> 
    
</body>
</html>